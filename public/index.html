<!DOCTYPE html>
<html lang='en'>
  <head>
    <title>Grapevine Beta</title>
    <meta charset='utf-8' />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

    <!-- Styles -->
    <link rel="stylesheet" href="/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/css/normalize.css">
    <link rel="stylesheet" href="/css/emberui.css">
    <link rel="stylesheet" href="/css/default-theme.css">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <link rel="stylesheet" href="/css/custom.css"/>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script type="text/javascript" src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Random dependecies -->
    <script src="/js/lib/jquery.js"></script>   
    <script src="/js/lib/bootstrap.min.js"></script>

    <!-- Maps stuff -->
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCqoUGXPM_78IoXgBMEVwjzXq8jG3nxx64"> </script>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?libraries=places&sensor=false"></script>
    <script src="/js/lib/gmaps.js"></script>
    <script src="/js/lib/locationpicker.jquery.js"></script>
    <script src="/js/lib/jquery.geocomplete.min.js"></script>    

      <!-- Ember + Ember Data -->
    <script src="/js/lib/handlebars-v1.3.0.js"></script>
    <script src="/js/lib/ember.js"></script>
    <script src="/js/lib/ember-data.js"></script>

    <!-- Ember UI -->
    <script src="/js/lib/list-view-latest.js"></script>
    <script src="/js/lib/moment.js"></script>
    <script src="/js/lib/jquery.velocity.min.js"></script>
    <script src="/js/lib/emberui.js"></script>
    
    <!-- UserApp -->
    <script src="/js/lib/userapp.client.js"></script>
    <script src="/js/lib/ember-userapp.js"></script>

    <!-- Firebase -->
    <script src="/js/lib/firebase.js"></script>
    <script src="/js/lib/emberfire.js"></script>

    <!-- GeoFirebase -->
    <script src="/js/lib/rsvp.js"></script>
    <script src="/js/lib/geofire.js"></script>

    <!-- Main JS File -->
    <script src="/js/app.js"></script>

  </head>
  <body>

<script type="text/x-handlebars">
  <div class='navbar navbar-default navbar-static-top'>
    <div class='container-fluid' id="header">
      <div class="navbar-header">
       {{#link-to 'index'}} <img src="images/Grapevine-Mockups.png" height="50px"/> {{/link-to}}
      </div>
      <div class="pull-right" style="margin-top:8px">
          <div class="dropdown">
            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
            <span class="glyphicon glyphicon-user"></span> 
            {{#if user.authenticated}}
              {{user.current.email}} 
            {{else}}
              Not Logged In
            {{/if}}
            <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" role="menu">
              {{#if user.authenticated}}
                <li>
                  <a href="#" {{action 'logout'}}>
                    <span class="glyphicon glyphicon-log-out"></span> 
                    Log Out
                  </a>
                </li>
              {{else}}
                <li>
                  {{#link-to 'login'}}
                    <span class="glyphicon glyphicon-log-in"></span> 
                    Login
                  {{/link-to}}
                </li>
                <li>
                  {{#link-to 'signup'}}
                    <span class="glyphicon glyphicon-heart"></span> 
                    Sign Up
                  {{/link-to}}
                </li>
                {{/if}}
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
  {{outlet}}
</script>

<script type="text/x-handlebars" data-template-name="newissue">
  {{eui-input valueBinding='issueTitle'}}
  {{eui-input valueBinding='issueContent'}}

  {{eui-button label='Create Issue' action='createIssue'}}
</script>

<script type="text/x-handlebars" data-template-name="newpost">
  Creating Post for <b>{{issue}}</b> Issue
  {{eui-input valueBinding='postTitle'}}
  {{eui-input valueBinding='postContent'}}
  {{location-picker latitude=latitude longitude=longitude radius=radius}}
  {{eui-button label='Create Post' action='createPost'}}
</script>

<script type="text/x-handlebars" data-template-name="index">
  <div class='container-fluid fullscreen'>
    <div class='row fullscreen'>
      <div class='col-md-8 fullscreen'>
        <!--filter dropdown list
        
        <div class="dropdown">
          <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown">
            All Categories
            <span class="caret"></span>
          </button>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Action</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Another action</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Something else here</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Separated link</a></li>
          </ul>
        </div>  

        end filter dropdown list-->
        
        <!--map div-->      
        {{google-maps latitude=selectedLocation.latitude longitude=selectedLocation.longitude markers=markers}}
      </div>
      <!--issues-->
      <div class='col-md-4' id="content">
        <div id="subcontent"  >
          {{#each issue in model}}
            {{#link-to 'issue' issue.id}}
            <div class='well issue'>
              <h2>
                {{issue.title}}
              </h2>
              <span class="glyphicon glyphicon-time"></span> 
              {{issue.created}}, first spotted
              <br/>
              <span class="glyphicon glyphicon-pencil"></span> 
              {{issue.created}}, last updated
              <br/>
              {{!--  
              <a href="index.html">
                <span class="glyphicon glyphicon-globe"></span> 

              </a>
              <br/>
               --}}
              <span class="glyphicon glyphicon-send"></span> 
              {{#if issue.posts}}
                {{issue.posts.length}} Posts
              {{else}}
                0 Posts.
              {{/if}}
              <br/>
              <br/>
              <p>
                {{#if issue.content}}
                  {{issue.content}}
                {{else}}
                  No content yet.
                {{/if}}   
              </p>
            </div>
            {{/link-to}}
          {{/each}}

          <div class="well new">
              {{#link-to 'newissue'}}
                <span class="glyphicon glyphicon-plus"></span>
                Add new issue
              {{/link-to}}
          </div>
        </div>
      </div>        
    </div>        
  </div>        
</script>

<script type="text/x-handlebars" data-template-name="loading">
  <div id="loading">
    <img src="images/loading.gif"/>
    <p>Loading...</p>
  </div>
</script>

<script type="text/x-handlebars" data-template-name="issue">
 <div class='container-fluid fullscreen'>
    
    <div class='row fullscreen'>
      <div class='col-md-8 fullscreen'>
        <h1>{{title}}</h1>
        {{#if content}}
          {{content}}
        {{/if}}
        <!--map div-->   
        {{google-maps latitude=selectedLocation.latitude longitude=selectedLocation.longitude markers=markers}}
      </div>
      
      <!--posts -->
      <div class='col-md-4' id="content">
        <div id="subcontent">
         {{#each post in posts}}
            <div class='well'>
              <h2>
                {{post.title}}
              </h2>
              <span class="glyphicon glyphicon-time"></span> 
              {{post.created}}
              <br/>
              <span class="glyphicon glyphicon-globe"></span> 
              {{post.longitude}}, {{post.latitude}}
              <br/>
              
              <span class="glyphicon glyphicon-user"></span> 
              {{#if post.user}}
                {{post.user.email}}
              {{else}}
                Anonymous
              {{/if}}
              <br/>
              <br/>
              <p>
                {{post.content}}
              </p>
            </div>
          {{/each}}

          <div class="well">
              {{#link-to 'newpost' id}}
                <span class="glyphicon glyphicon-plus"></span>
                Add new posts to issue 
              {{/link-to}}
          </div>
        </div>
      </div>  
    </div>        
  </div>        
</script>

<script type="text/x-handlebars" data-template-name="login">
    <form {{action login on='submit'}}>
        <label for="username">Username</label>
        {{input id='username' placeholder='Enter Username' class='form-control' value=username}}
        <label for="password">Password</label>
        {{input id='password' placeholder='Enter Password' class='form-control' type='password' value=password}}
        <button type="submit" class="btn btn-default">Login</button>
    </form>
    {{#if error}}
        <div class="alert alert-error">{{error.message}}</div>
    {{/if}}
</script>

<script type="text/x-handlebars" data-template-name="signup">
    <form {{action signup on='submit'}}>
        <label for="username">Username</label>
        {{input id='username' placeholder='Enter a Username' class='form-control' value=username}}
        <label for="email">Email</label>
        {{input id='email' placeholder='Enter your Email' class='form-control' value=email}}
        <label for="password">Password</label>
        {{input id='password' placeholder='Enter a Password' class='form-control' type='password' value=password}}
        <button type="submit" class="btn btn-default">Sign up</button>
    </form>
    {{#if error}}
        <div class="alert alert-error">{{error.message}}</div>
    {{/if}}
</script>
  
<script type="text/x-handlebars" id="components/google-maps">
  <div class="map-canvas"></div>
</script>

<script type="text/x-handlebars" id="components/location-picker">
  Location: <input type="text" id="picker-address"/>
  Radius: <input type="text" id="picker-radius"/>
  <div id="location-picker"></div>       
  Lat.: <input type="text" id="picker-latitude"/>
  Long.: <input type="text" id="picker-longitude"/>
</script>

  </body>
</html>
